# Docker Compose for Production - Backend Only
# Face Recognition API with authentication and HTTPS ready
#
# Usage:
#   docker compose -f docker-compose.prod.yml up -d --build
#
# All configuration is in ./services/face-recognition/.env.prod

services:
  backend:
    build:
      context: ./services/face-recognition
      dockerfile: Dockerfile
    container_name: facial_recog_api
    env_file:
      - ./services/face-recognition/.env.prod
    ports:
      - "${API_PORT:-8000}:8000"
    volumes:
      # Mount models directory (read-write for HNSW index persistence)
      - ./services/face-recognition/app/models:/app/app/models:rw
    restart: always
    deploy:
      resources:
        limits:
          memory: 4G
        reservations:
          memory: 2G
    networks:
      - api_network

networks:
  api_network:
    driver: bridge
